(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(1488)}])},1488:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return HomePage}});var n=s(5893),i=s(7294);function WelcomeScreen(e){let{onStart:t}=e;return(0,n.jsxs)("div",{className:"text-center p-6",children:[(0,n.jsx)("h2",{className:"text-2xl sm:text-3xl font-semibold text-indigo-700 mb-4",children:"Welcome to the MEMA Consultants FinProms Compliance Questionnaire"}),(0,n.jsx)("p",{className:"text-md text-slate-700 mb-6",children:"This tool will guide you through a series of questions based on FCA requirements from COBS 4, PERG 8, FG24/1, and PS23/13 to help assess the compliance of your financial promotions."}),(0,n.jsx)("button",{onClick:t,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition duration-150 ease-in-out",children:"Start Questionnaire"}),(0,n.jsxs)("p",{className:"text-xs text-slate-500 mt-8",children:[(0,n.jsx)("strong",{children:"Disclaimer:"})," This questionnaire is not exhaustive and is not a substitute for professional legal or compliance advice."]})]})}function Questionnaire(e){let{question:t,onAnswer:s,currentIndex:a,totalQuestions:l}=e,[o,r]=(0,i.useState)(null);return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"text-center mb-4 text-slate-600",children:["Question ",a+1," of ",l]}),(0,n.jsxs)("div",{className:"question-card",children:[(0,n.jsxs)("p",{className:"question-ref",children:["Ref: ",t.questionRef]}),(0,n.jsx)("p",{className:"question-text",children:t.questionText}),(0,n.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),null===o){alert("Please select an answer.");return}s(t.id,o),r(null)},children:[(0,n.jsxs)("div",{className:"flex justify-center space-x-4 my-6",children:[(0,n.jsx)("button",{onClick:()=>r("Yes"),className:"px-6 py-2 rounded-lg ".concat("Yes"===o?"bg-indigo-700 text-white":"bg-slate-200"),children:"Yes"}),(0,n.jsx)("button",{onClick:()=>r("No"),className:"px-6 py-2 rounded-lg ".concat("No"===o?"bg-indigo-700 text-white":"bg-slate-200"),children:"No"})]}),(0,n.jsx)("div",{className:"navigation-buttons mt-8 flex justify-end",children:(0,n.jsx)("button",{type:"submit",className:"bg-indigo-600 hover:bg-indigo-700",children:"Next Question"})})]})]})]})}var a=s(3148),l=s(6495);function ResultsPage(e){let{answers:t,questions:s,onRestart:a}=e,[o,r]=(0,i.useState)({email:"",phone:""}),[c,d]=(0,i.useState)(!1),[u,m]=(0,i.useState)(""),x=(0,i.useMemo)(()=>{let e=[],n={},i=0,a=0;s.forEach(s=>{let l=t[s.id];if(null==l||""===l)return;i++;let o=!0,r="";"yesno"===s.type&&"No"===l&&s.complianceImplicationIfNo&&(o=!1,r=s.complianceImplicationIfNo);let c=s.complianceImplicationIfSelected?JSON.parse(s.complianceImplicationIfSelected):{};"dropdown"===s.type&&c[l]&&(o=!1,r=c[l]),"multiselect"===s.type&&Array.isArray(l)&&l.forEach(e=>{c[e]&&(o=!1,r=(r?r+"; ":"")+c[e])}),o?a++:e.push({...s,implicationText:r,userAnswer:l}),n[s.sectionTitle]||(n[s.sectionTitle]={compliant:0,nonCompliant:0}),o?n[s.sectionTitle].compliant++:n[s.sectionTitle].nonCompliant++});let l=i>0?Math.round(a/i*100):100;return{potentialFailures:e,sectionScores:n,healthScore:l}},[t,s]),handleInputChange=e=>{let{name:t,value:s}=e.target;r(e=>({...e,[t]:s}))},handleFormSubmit=async e=>{e.preventDefault(),d(!0),m("");try{let e=await fetch("/api/leads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!e.ok)throw Error("Server responded with an error.");m("Success! Your details have been sent.")}catch(e){m("Error: Could not submit details. Please try again."),console.error("Failed to submit lead:",e)}finally{d(!1)}},h={labels:["Compliant Aspects (%)","Potential Issues (%)"],datasets:[{data:[x.healthScore,100-x.healthScore],backgroundColor:[x.healthScore>=90?"#10b981":x.healthScore>=60?"#f59e0b":"#ef4444","#e2e8f0"],borderColor:"#ffffff",borderWidth:4}]},p={labels:Object.keys(x.sectionScores),datasets:[{label:"Compliant Answers",data:Object.values(x.sectionScores).map(e=>e.compliant),backgroundColor:"rgba(34, 197, 94, 0.8)"},{label:"Potential Issues",data:Object.values(x.sectionScores).map(e=>e.nonCompliant),backgroundColor:"rgba(239, 68, 68, 0.8)"}]};return(0,n.jsxs)("div",{className:"results-section",children:[(0,n.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold text-indigo-700 mb-6 text-center",children:"Compliance Questionnaire Summary"}),(0,n.jsxs)("div",{className:"mt-10 p-6 border-t-4 border-indigo-600 bg-indigo-50 rounded-lg shadow-xl text-center",children:[(0,n.jsx)("h3",{className:"text-2xl font-semibold text-indigo-700 mb-2",children:"Overall Compliance Health"}),(0,n.jsx)("div",{id:"overall-health-chart-container",children:(0,n.jsx)(l.$I,{data:h,options:{responsive:!0,maintainAspectRatio:!1,cutout:"70%"}})}),(0,n.jsxs)("p",{className:"text-4xl font-bold mt-4 ".concat(x.healthScore<60?"text-red-600":"text-green-600"),children:[x.healthScore,"%"]})]}),x.potentialFailures.length>0&&(0,n.jsxs)("div",{className:"mt-10 p-6 bg-white rounded-lg shadow-md",children:[(0,n.jsx)("h3",{className:"text-2xl font-semibold text-indigo-700 mb-4",children:"Potential Issues Identified"}),x.potentialFailures.map(e=>(0,n.jsxs)("div",{className:"potential-failure-item",children:[(0,n.jsxs)("p",{className:"font-medium text-slate-700",children:[e.id,": ",e.questionText]}),(0,n.jsxs)("div",{className:"mt-2 text-xs p-2 rounded bg-red-50 border border-red-200",children:[(0,n.jsx)("strong",{className:"text-red-800",children:"Potential Implication:"}),(0,n.jsxs)("span",{className:"text-slate-700",children:[" ",e.implicationText]})]})]},e.id))]}),(0,n.jsxs)("div",{id:"export-contact-section",className:"export-contact-form",children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-indigo-700 mb-2 text-center",children:"Get Your Full Report"}),(0,n.jsx)("p",{className:"text-slate-600 text-sm mb-4 text-center",children:"To receive a full report and discuss your results, please provide your details below. Our team will be in touch."}),(0,n.jsxs)("form",{onSubmit:handleFormSubmit,children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("input",{type:"email",name:"email",placeholder:"you@company.com",required:!0,value:o.email,onChange:handleInputChange}),(0,n.jsx)("input",{type:"tel",name:"phone",placeholder:"07123 456789",required:!0,value:o.phone,onChange:handleInputChange}),(0,n.jsx)("button",{type:"submit",disabled:c,children:c?"Submitting...":"Submit Details"})]}),u&&(0,n.jsx)("p",{className:"text-center mt-4 text-sm",children:u})]})]}),(0,n.jsx)("div",{className:"chart-container",children:(0,n.jsx)(l.$Q,{options:{responsive:!0,scales:{x:{stacked:!0},y:{stacked:!0}},plugins:{title:{display:!0,text:"Breakdown by Section"}}},data:p})}),(0,n.jsx)("div",{className:"results-nav text-center mt-8",children:(0,n.jsx)("button",{onClick:a,className:"bg-slate-500 hover:bg-slate-600",children:"â† Back to Start"})})]})}function HomePage(){let[e,t]=(0,i.useState)("welcome"),[s,a]=(0,i.useState)([]),[l,o]=(0,i.useState)(0),[r,c]=(0,i.useState)({});return((0,i.useEffect)(()=>{let fetchQuestions=async()=>{try{let e=await fetch("/api/questions"),t=await e.json();a(t)}catch(e){console.error("Failed to fetch questions:",e)}};fetchQuestions()},[]),0===s.length)?(0,n.jsx)("div",{children:"Loading Questionnaire..."}):(0,n.jsxs)("div",{className:"min-h-screen bg-slate-100 font-sans",children:[(0,n.jsx)("header",{className:"bg-indigo-700 text-white p-4 shadow-lg sticky top-0 z-50",children:(0,n.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,n.jsx)("h1",{className:"text-xl sm:text-2xl font-semibold",children:"MEMA Consultants - Financial Promotions Questionnaire"}),"active"===e&&(0,n.jsx)("button",{onClick:()=>t("results"),className:"bg-indigo-500 hover:bg-indigo-400 text-white font-semibold py-2 px-4 rounded-lg transition",children:"View Results"})]})}),(0,n.jsxs)("main",{className:"app-container flex-grow",children:["welcome"===e&&(0,n.jsx)(WelcomeScreen,{onStart:()=>{t("active")}}),"active"===e&&(0,n.jsx)(Questionnaire,{question:s[l],onAnswer:(e,n)=>{c(t=>({...t,[e]:n})),l<s.length-1?o(e=>e+1):t("results")},currentIndex:l,totalQuestions:s.length}),"results"===e&&(0,n.jsx)(ResultsPage,{answers:r,questions:s,onRestart:()=>{c({}),o(0),t("welcome")}})]}),(0,n.jsx)("footer",{className:"text-center p-4 text-sm text-slate-500 bg-slate-200 mt-auto",children:"MEMA Consultants - Financial Promotions Questionnaire"})]})}a.kL.register(a.qi,a.u,a.De,a.uw,a.f$,a.ZL,a.Dx)}},function(e){e.O(0,[774,196,421,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);