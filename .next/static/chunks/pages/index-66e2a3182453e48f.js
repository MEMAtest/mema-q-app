(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(2967)}])},2967:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Home}});var n=s(5893),a=s(7294),i=s(9008),l=s.n(i);function WelcomeScreen(e){let{onStart:t}=e;return(0,n.jsxs)("div",{className:"text-center p-6",children:[(0,n.jsx)("h2",{className:"text-2xl sm:text-3xl font-semibold text-indigo-700 mb-4",children:"Welcome to the MEMA Consultants FinProms Compliance Questionnaire"}),(0,n.jsx)("p",{className:"text-md text-slate-700 mb-6",children:"This tool will guide you through a series of questions based on FCA requirements from COBS 4, PERG 8, FG24/1, and PS23/13 to help assess the compliance of your financial promotions."}),(0,n.jsx)("button",{onClick:t,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition duration-150 ease-in-out",children:"Start Questionnaire"}),(0,n.jsxs)("p",{className:"text-xs text-slate-500 mt-8",children:[(0,n.jsx)("strong",{children:"Disclaimer:"})," This questionnaire is not exhaustive and is not a substitute for professional legal or compliance advice."]})]})}var components_Questionnaire=e=>{let{section:t,question:s,onAnswer:a,onNext:i,onPrev:l,isFirstQuestion:o,isLastQuestion:r,currentAnswer:c}=e,handleOptionChange=e=>{a(s.id,{answer:e.target.value,notes:(null==c?void 0:c.notes)||""})};return(0,n.jsxs)("div",{className:"app-container",children:[(0,n.jsxs)("div",{className:"question-card",children:[(0,n.jsxs)("div",{className:"question-header",children:[(0,n.jsxs)("p",{className:"question-ref",children:["Ref: ",s.id]}),(0,n.jsx)("span",{className:"explainer-icon",title:s.explanation,children:"ℹ️"})]}),(0,n.jsx)("p",{className:"question-text",children:s.questionText}),(0,n.jsx)("div",{className:"answer-options my-6",children:(()=>{let{type:e,options:t}=s,a=null==c?void 0:c.answer;return"yesno"===e?["Yes","No"].map(e=>(0,n.jsxs)("label",{className:"radio-label",children:[(0,n.jsx)("input",{type:"radio",name:s.id,value:e,checked:a===e,onChange:handleOptionChange}),(0,n.jsx)("span",{children:e})]},e)):"dropdown"===e?(0,n.jsx)("select",{value:a||"",onChange:handleOptionChange,children:t.map(e=>(0,n.jsx)("option",{value:e.value,children:e.text},e.value))}):null})()}),(0,n.jsxs)("div",{className:"notes-area mt-6",children:[(0,n.jsx)("label",{htmlFor:"notes",className:"block text-sm font-semibold text-slate-700 mb-1",children:"Notes/Considerations (Optional):"}),(0,n.jsx)("textarea",{id:"notes",className:"w-full p-2 border border-slate-300 rounded-md",placeholder:"Enter any specific notes or justifications...",value:(null==c?void 0:c.notes)||"",onChange:e=>{a(s.id,{answer:null==c?void 0:c.answer,notes:e.target.value})},rows:"4"})]})]}),(0,n.jsxs)("div",{className:"navigation-buttons mt-8 flex justify-between",children:[(0,n.jsx)("button",{onClick:l,disabled:o,children:"Previous"}),(0,n.jsx)("button",{onClick:i,children:r?"Finish & View Results":"Next"})]})]})},o=s(6495),r=s(3148);r.kL.register(r.qi,r.u,r.De,r.uw,r.f$,r.ZL,r.Dx);var components_ResultsPage=e=>{let{results:t,onGoBack:s}=e,[i,l]=(0,a.useState)(""),[r,c]=(0,a.useState)(""),[d,u]=(0,a.useState)({status:"idle",message:""});if(!t)return(0,n.jsx)("div",{children:"Loading results..."});let{potentialFailures:m,healthScore:x,chartData:h}=t,handleLeadSubmit=async e=>{e.preventDefault(),u({status:"loading",message:""});try{let e=await fetch("/api/leads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i,phone:r})});if(!e.ok)throw Error("Submission failed");await e.json(),u({status:"success",message:"Thank you! We will be in touch shortly."})}catch(e){u({status:"error",message:"Something went wrong. Please try again."})}};return(0,n.jsxs)("div",{className:"app-container",children:[(0,n.jsx)("h2",{className:"text-3xl font-bold text-indigo-700 mb-6 text-center",children:"Compliance Summary"}),(0,n.jsxs)("div",{className:"text-center p-6 bg-indigo-50 rounded-lg",children:[(0,n.jsx)("h3",{className:"text-2xl font-semibold text-indigo-700 mb-2",children:"Overall Compliance Health"}),(0,n.jsx)("div",{id:"overall-health-chart-container",children:(0,n.jsx)(o.$I,{data:{labels:["Compliant","Issues/Unanswered"],datasets:[{data:h.doughnut,backgroundColor:["#10b981","#ef4444"],borderWidth:4}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"70%",plugins:{legend:{display:!1}}}})}),(0,n.jsxs)("p",{className:"text-4xl font-bold mt-4 text-green-600",children:[x,"%"]})]}),(0,n.jsxs)("div",{className:"mt-10",children:[(0,n.jsx)("h3",{className:"text-2xl font-semibold text-indigo-700 mb-4",children:"Potential Failures Identified"}),m.length>0?m.map(e=>(0,n.jsxs)("div",{className:"potential-failure-item",children:[(0,n.jsxs)("p",{className:"font-semibold text-slate-800",children:[e.id,": ",e.question]}),(0,n.jsxs)("div",{className:"mt-2 text-sm p-2 rounded bg-red-100 border border-red-200",children:[(0,n.jsx)("strong",{className:"text-red-800",children:"Potential Implication: "}),(0,n.jsx)("span",{className:"text-slate-700",children:e.implication})]})]},e.id)):(0,n.jsx)("p",{className:"text-green-700 bg-green-100 p-4 rounded-md",children:"No critical compliance issues were flagged based on your answers."})]}),(0,n.jsxs)("div",{className:"mt-10",children:[(0,n.jsx)("h3",{className:"text-2xl font-semibold text-indigo-700 mb-4",children:"Detailed Breakdown"}),(0,n.jsx)("div",{className:"chart-container",children:(0,n.jsx)(o.$Q,{data:h.bar,options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",scales:{x:{stacked:!0},y:{stacked:!0}},plugins:{title:{display:!0,text:"Responses by Section"},legend:{position:"top"}}}})})]}),(0,n.jsx)("div",{id:"export-contact-section",className:"export-contact-form",children:"success"!==d.status?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-indigo-700 mb-2 text-center",children:"Request a Full Report"}),(0,n.jsx)("p",{className:"text-slate-600 text-sm mb-4 text-center",children:"Provide your details and our team will contact you with a full analysis."}),(0,n.jsx)("form",{onSubmit:handleLeadSubmit})]}):(0,n.jsx)("p",{className:"text-center text-lg font-semibold text-green-700",children:d.message})}),(0,n.jsx)("div",{className:"text-center mt-8",children:(0,n.jsx)("button",{onClick:s,className:"bg-slate-500 hover:bg-slate-600 text-white font-semibold py-2 px-4 rounded-lg",children:"← Back to Questionnaire"})})]})},components_Stepper=e=>{let{sections:t,currentSectionIndex:s,onStepClick:a}=e;return(0,n.jsx)("ol",{className:"stepper",children:t.map((e,t)=>{let i=t<s,l=t===s,o="step";return l?o+=" active":i&&(o+=" completed"),(0,n.jsxs)("li",{className:o,onClick:()=>a(t),children:[(0,n.jsx)("div",{className:"dot"}),(0,n.jsx)("div",{className:"label",children:e.title})]},e.id||t)})})};function Home(){let[e,t]=(0,a.useState)("welcome"),[s,i]=(0,a.useState)([]),[o,r]=(0,a.useState)(0),[c,d]=(0,a.useState)(0),[u,m]=(0,a.useState)({}),[x,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{let fetchQuestions=async()=>{try{let e=await fetch("/api/questions");if(!e.ok)throw Error("Failed to fetch questions");let t=await e.json();i(t)}catch(e){console.error("Error fetching questions:",e)}};fetchQuestions()},[]);let handleShowResults=()=>{let e=analyzeResults();h(e),t("results")},analyzeResults=()=>{let e=[],t=0,n=0,a=s.map(s=>{let a=0,i=0,l=0,o=0;return s.items.forEach(s=>{var r,c;let d=null===(r=u[s.id])||void 0===r?void 0:r.answer,m=!1,x="";d&&n++,"yesno"===s.type?"Yes"===d?(t++,a++):"No"===d?(i++,s.complianceImplicationIfNo&&(m=!0,x=s.complianceImplicationIfNo)):o++:"dropdown"===s.type&&(d&&s.complianceImplicationIfSelected&&s.complianceImplicationIfSelected[d]?(m=!0,x=s.complianceImplicationIfSelected[d],i++):d?(t++,l++):o++),m&&e.push({id:s.id,question:s.questionText,ref:s.ref,implication:x,notes:(null===(c=u[s.id])||void 0===c?void 0:c.notes)||""})}),{title:s.sectionTitle.replace(/Section \d+: /g,""),counts:[a,i,l,o]}}),i=n>0?Math.round(t/n*100):0,l={doughnut:[i,100-i],bar:{labels:a.map(e=>e.title),datasets:[{label:"Yes",data:a.map(e=>e.counts[0]),backgroundColor:"rgba(56, 189, 123, 0.7)"},{label:"No / Issue",data:a.map(e=>e.counts[1]),backgroundColor:"rgba(239, 68, 68, 0.7)"},{label:"Other",data:a.map(e=>e.counts[2]),backgroundColor:"rgba(99, 102, 241, 0.7)"},{label:"Unanswered",data:a.map(e=>e.counts[3]),backgroundColor:"rgba(245, 158, 11, 0.7)"}]}};return{potentialFailures:e,healthScore:i,chartData:l}},p=s.map(e=>({id:e.id,title:e.sectionTitle}));return(0,n.jsxs)("div",{children:[(0,n.jsx)(l(),{children:(0,n.jsx)("title",{children:"MEMA Financial Promotions App"})}),(0,n.jsxs)("main",{children:["questionnaire"===e&&s.length>0&&(0,n.jsx)("div",{className:"container mx-auto px-4 mt-6",children:(0,n.jsx)(components_Stepper,{sections:p,currentSectionIndex:o,onStepClick:e=>{e<=o&&(r(e),d(0))}})}),"welcome"===e&&(0,n.jsx)(WelcomeScreen,{onStart:()=>{t("questionnaire")}}),"questionnaire"===e&&s.length>0?(0,n.jsx)(components_Questionnaire,{section:s[o],question:s[o].items[c],onAnswer:(e,t)=>{m(s=>({...s,[e]:t}))},onNext:()=>{let e=s[o];c<e.items.length-1?d(e=>e+1):o<s.length-1?(r(e=>e+1),d(0)):handleShowResults()},onPrev:()=>{if(c>0)d(e=>e-1);else if(o>0){let e=o-1,t=s[e];r(e),d(t.items.length-1)}},isFirstQuestion:0===o&&0===c,isLastQuestion:o===s.length-1&&c===s[o].items.length-1,currentAnswer:u[s[o].items[c].id]}):"questionnaire"===e?(0,n.jsx)("div",{className:"app-container text-center",children:"Loading questions..."}):null,"results"===e&&(0,n.jsx)(components_ResultsPage,{results:x,onGoBack:()=>{t("questionnaire")}})]})]})}}},function(e){e.O(0,[774,196,538,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);